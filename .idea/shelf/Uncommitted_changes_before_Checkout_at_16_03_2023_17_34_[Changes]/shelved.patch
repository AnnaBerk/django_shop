Index: easyshop/shop/views.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\nfrom django.http import Http404\r\nfrom django.shortcuts import render, get_object_or_404\r\nimport requests\r\nfrom django.views.generic import ListView, DetailView\r\nfrom .models import Category, Product\r\nfrom cart.forms import CartAddProductForm\r\n\r\n\r\nclass ProductListView(ListView):\r\n    model = Product\r\n    template_name = 'shop/product/list.html'\r\n    context_object_name = 'products'\r\n    paginate_by = 10\r\n\r\n    def get_queryset(self):\r\n        queryset = super().get_queryset()\r\n        if self.kwargs.get('slug'):\r\n            category = get_object_or_404(Category, slug=self.kwargs['slug'])\r\n            queryset = queryset.filter(category=category)\r\n        queryset = queryset.filter(available=True)\r\n        return queryset\r\n\r\n    def get_context_data(self, **kwargs):\r\n        context = super().get_context_data(**kwargs)\r\n        category_slug = self.kwargs.get('slug')\r\n        if category_slug:\r\n            category = get_object_or_404(Category, slug=category_slug)\r\n            context['category'] = category\r\n            context['products'] = Product.objects.filter(category=category, available=True)\r\n        else:\r\n            context['products'] = Product.objects.filter(available=True)\r\n        context['categories'] = Category.objects.all()\r\n        return context\r\n\r\n\r\nclass ProductDetailView(DetailView):\r\n    model = Product\r\n    template_name = 'shop/product/detail.html'\r\n    context_object_name = 'product'\r\n\r\n    def get_queryset(self):\r\n        queryset = super().get_queryset()\r\n        return queryset.filter(available=True)\r\n\r\n    def get_object(self, queryset=None):\r\n        obj = super().get_object(queryset=queryset)\r\n        if not obj.available:\r\n            raise Http404(\"Product does not exist\")\r\n        return obj\r\n\r\n    def get_context_data(self, **kwargs):\r\n        context = super().get_context_data(**kwargs)\r\n        cart_product_form = CartAddProductForm()\r\n        context['cart_product_form'] = cart_product_form\r\n        return context\r\n\r\n\r\n\r\n\r\n\r\n\r\n# def load_products(request):\r\n#     r = requests.get('https://fakestoreapi.com/products')\r\n#     for item in r.json():\r\n#         product = Product(\r\n#             name=item['title'],\r\n#             description=item['description'],\r\n#             price=item['price'],\r\n#             image=item['image'],\r\n#             stock=10,\r\n#         )\r\n#         product.save()\r\n#     return render(request, 'shop/product/list.html')
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/easyshop/shop/views.py b/easyshop/shop/views.py
--- a/easyshop/shop/views.py	(revision 32b01ccb1f9907f4826b18c70afd987778b7c40e)
+++ b/easyshop/shop/views.py	(date 1678966411175)
@@ -1,4 +1,3 @@
-
 from django.http import Http404
 from django.shortcuts import render, get_object_or_404
 import requests
