Index: easyshop/templates/shop/product/list.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends \"shop/base.html\" %}\r\n{% load thumbnail %}\r\n{% load static %}\r\n{% block title %}\r\n    {% if category %}{{ category.name }}{% else %}Products{% endif %}\r\n{% endblock %}\r\n{% block content %}\r\n    <div id=\"sidebar\">\r\n        <h3>Categories</h3>\r\n        <ul>\r\n            <li {% if not category %}class=\"selected\"{% endif %}>\r\n                <a href=\"{% url 'shop:product_list' %}\">All</a>\r\n            </li>\r\n            {% for c in categories %}\r\n                <li {% if category.slug == c.slug %}class=\"selected\"{% endif %}>\r\n                    <a href=\"{{ c.get_absolute_url }}\">{{ c.name }}</a>\r\n                </li>\r\n            {% endfor %}\r\n        </ul>\r\n    </div>\r\n    <div id=\"main\" class=\"product-list\">\r\n        <h1>{% if category %}{{ category.name }}{% else %}Products{% endif %}</h1>\r\n        {% for product in products %}\r\n            <div class=\"item\">\r\n                <a href=\"{{ product.get_absolute_url }}\">\r\n                    <img src=\"{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}\" style=\"width: 200px; height: 200px;\">\r\n                </a>\r\n                <a href=\"{{ product.get_absolute_url }}\">{{ product.name }}</a><br>\r\n                ${{ product.price }}\r\n            </div>\r\n        {% endfor %}\r\n    </div>\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/easyshop/templates/shop/product/list.html b/easyshop/templates/shop/product/list.html
--- a/easyshop/templates/shop/product/list.html	(revision 46d9e6e5bd0d7d80550039381d37c1a0496a2be3)
+++ b/easyshop/templates/shop/product/list.html	(date 1679054595507)
@@ -19,6 +19,7 @@
         </ul>
     </div>
     <div id="main" class="product-list">
+        <h5> Всего продуктов {{ total_products }}</h5>
         <h1>{% if category %}{{ category.name }}{% else %}Products{% endif %}</h1>
         {% for product in products %}
             <div class="item">
Index: easyshop/shop/views.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.http import Http404\r\nfrom django.shortcuts import render, get_object_or_404\r\nimport requests\r\nfrom django.views.generic import ListView, DetailView\r\nfrom .models import Category, Product\r\nfrom cart.forms import CartAddProductForm\r\n\r\n\r\nclass ProductListView(ListView):\r\n    model = Product\r\n    template_name = 'shop/product/list.html'\r\n    context_object_name = 'products'\r\n#     paginate_by = 10\r\n\r\n    def get_queryset(self):\r\n        queryset = super().get_queryset()\r\n\r\n        category_slug = self.kwargs.get('slug')\r\n        if category_slug:\r\n            queryset = queryset.filter(category__slug=category_slug)\r\n\r\n        fields = ['id', 'slug', 'name', 'price', 'image', 'category']\r\n        return queryset.only(*fields)\r\n\r\n    def get_context_data(self, **kwargs):\r\n        context = super().get_context_data(**kwargs)\r\n        category_slug = self.kwargs.get('slug')\r\n        if category_slug:\r\n            category = get_object_or_404(Category, slug=category_slug)\r\n            context['category'] = category\r\n        context['categories'] = Category.objects.all()\r\n        return context\r\n\r\n\r\nclass ProductDetailView(DetailView):\r\n    model = Product\r\n    template_name = 'shop/product/detail.html'\r\n    context_object_name = 'product'\r\n\r\n    def get_object(self, queryset=None):\r\n        # Use select_related() to fetch the related Category object with the\r\n        # product\r\n        return super().get_object()\r\n\r\n    def get_context_data(self, **kwargs):\r\n        context = super().get_context_data(**kwargs)\r\n        cart_product_form = CartAddProductForm()\r\n        context['cart_product_form'] = cart_product_form\r\n        return context\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/easyshop/shop/views.py b/easyshop/shop/views.py
--- a/easyshop/shop/views.py	(revision 46d9e6e5bd0d7d80550039381d37c1a0496a2be3)
+++ b/easyshop/shop/views.py	(date 1679061307864)
@@ -29,6 +29,7 @@
             category = get_object_or_404(Category, slug=category_slug)
             context['category'] = category
         context['categories'] = Category.objects.all()
+        context['total_products'] = self.get_queryset().count()
         return context
 
 
@@ -37,11 +38,6 @@
     template_name = 'shop/product/detail.html'
     context_object_name = 'product'
 
-    def get_object(self, queryset=None):
-        # Use select_related() to fetch the related Category object with the
-        # product
-        return super().get_object()
-
     def get_context_data(self, **kwargs):
         context = super().get_context_data(**kwargs)
         cart_product_form = CartAddProductForm()
